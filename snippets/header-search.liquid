<script src="{{ 'predictive-search.js' | asset_url }}" defer></script>

{%- liquid
    assign suggestedLinklist = settings.suggestedLinklist
    # theme-check-disable
    assign sort_by = search.sort_by | default: search.default_sort_by
    assign terms = search.terms | escape
    assign search_url = '?q=' | append: terms | append: '&options%5Bprefix%5D=last&sort_by=' | append: sort_by
    # theme-check-enable
-%}

<search-engine>
  <main-search>
    <form action="{{ routes.search_url }}" method="get" role="search" class="search">
      <div class="search-section" style="display: flex; flex-direction: column;">
        <div class="search-input-stack" style="display: flex; align-items: center;">
          <div style="padding-left: var(--boxPadding);">
            {%- render 'global-icon' with 'search' -%}
          </div>
          <div class="s-input fullwidth">
            <label for="Search-In-Template" class="visually-hidden">{{ 'search.search' | t }}</label>
            <input id="Search-In-Template" class="fullwidth"
              type="search"
              name="q"
              value="{{ search.terms | escape }}"
              placeholder="{{ 'search.search' | t }}"
              {%- if settings.predictive_search_enabled -%}
                aria-expanded="false"
                aria-owns="predictive-search-results"
                aria-controls="predictive-search-results"
                aria-haspopup="listbox"
                aria-autocomplete="list"
                autocorrect="off"
                autocomplete="off"
                autocapitalize="off"
                spellcheck="false"
              {%- endif -%}
            >
            <input type="hidden" name="options[prefix]" value="last">
          </div>
        </div>
      </div>
    </form>
  </main-search>
  {%- if settings.predictive_search_enabled -%}
  <predictive-search data-loading-text="{{ 'general.accessibility.loading' | t }}">
    <div class="predictive-search">
      <!-- Search results will be injected here -->
    </div>
  </predictive-search>
  {%- endif -%}
</search-engine>